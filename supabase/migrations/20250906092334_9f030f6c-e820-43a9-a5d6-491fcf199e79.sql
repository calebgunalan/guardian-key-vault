-- Add sample zero trust policies for demonstration
INSERT INTO public.zero_trust_policies (name, description, policy_type, conditions, actions, severity, is_active, created_by) VALUES
('Trusted Device Policy', 'Requires device to be marked as trusted for access to sensitive resources', 'device', '{"trusted_device_required": true, "min_trust_score": 70}', '{"action": "allow", "require_mfa": false}', 'medium', true, (SELECT id FROM auth.users LIMIT 1)),
('VPN Restriction Policy', 'Blocks access from VPN or proxy connections', 'network', '{"block_vpn": true, "allowed_ip_ranges": ["192.168.0.0/16", "10.0.0.0/8"]}', '{"action": "deny", "message": "VPN connections not allowed"}', 'high', true, (SELECT id FROM auth.users LIMIT 1)),
('Behavioral Anomaly Detection', 'Monitors user behavior patterns for suspicious activity', 'behavioral', '{"min_behavior_score": 60, "check_login_patterns": true}', '{"action": "require_mfa", "log_event": true}', 'high', true, (SELECT id FROM auth.users LIMIT 1)),
('Geographic Access Control', 'Restricts access based on geographic location', 'location', '{"allowed_countries": ["US", "CA", "GB"], "block_tor": true}', '{"action": "deny", "require_approval": true}', 'medium', true, (SELECT id FROM auth.users LIMIT 1)),
('Business Hours Policy', 'Allows access only during business hours (9 AM - 5 PM)', 'time_based', '{"start_time": "09:00", "end_time": "17:00", "timezone": "UTC", "days_of_week": [1,2,3,4,5]}', '{"action": "allow", "outside_hours_action": "require_approval"}', 'low', true, (SELECT id FROM auth.users LIMIT 1)),
('Critical System Access', 'Enhanced security for critical system access', 'device', '{"min_trust_score": 90, "require_biometric": true}', '{"action": "allow", "require_mfa": true, "session_timeout": 1800}', 'critical', true, (SELECT id FROM auth.users LIMIT 1));